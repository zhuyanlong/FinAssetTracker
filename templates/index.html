<!DOCTYPE html>
<html>
<head>
    <title>资产统计器</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .form-group { margin-bottom: 15px; }
        label { display: inline-block; width: 150px; }
        input { padding: 5px; }
        button { padding: 10px 20px; margin-top: 10px; }
        .result { margin-top: 20px; font-weight: bold; }
    </style>
    <script>
        function clearData() {
            if (confirm('确定要清除所有数据吗？')) {
                fetch('/clear')
                    .then(response => response.json())
                    .then(data => {
                        if (data.message) {
                            alert('数据已清除');
                            window.location.reload();
                        } else {
                            alert('清除数据失败');
                        }
                    })
                    .catch(error => alert('发生错误：' + error));
            }
        }
    </script>
</head>
<body>
    <h1>资产统计器</h1>
    <button class="clear-button" onclick="clearData()">清除所有数据</button>
    <form id="assetForm" method="post">
        <div class="form-group">
            <label>黄金（g）:</label>
            <input type="number" step="0.01" name="gold_g" value="{{ gold_g or 0 }}">
        </div>
        <div class="form-group">
            <label>黄金ETF（oz）:</label>
            <input type="number" step="0.01" name="gold_oz" value="{{ gold_oz or 0 }}">
        </div>
        <div class="form-group">
            <label>养老基金（人民币/元）:</label>
            <input type="number" step="0.01" name="retirement_funds_cny" value="{{ retirement_funds_cny or 0 }}">
        </div>
        <div class="form-group">
            <label>基金（人民币/元）:</label>
            <input type="number" step="0.01" name="funds_cny" value="{{ funds_cny or 0 }}">
        </div>
        <div class="form-group">
            <label>基金（新加坡/元）:</label>
            <input type="number" step="0.01" name="funds_sgd" value="{{ funds_sgd or 0 }}">
        </div>
        <div class="form-group">
            <label>基金（欧元/元）:</label>
            <input type="number" step="0.01" name="funds_eur" value="{{ funds_eur or 0 }}">
        </div>
        <div class="form-group">
            <label>基金（港币/元）:</label>
            <input type="number" step="0.01" name="funds_hkd" value="{{ funds_hkd or 0 }}">
        </div>
        <div class="form-group">
            <label>公积金（人民币/元）:</label>
            <input type="number" step="0.01" name="housing_fund_cny" value="{{ housing_fund_cny or 0 }}">
        </div>
        <div class="form-group">
            <label>存款（英镑/元）:</label>
            <input type="number" step="0.01" name="deposit_gbp" value="{{ deposit_gbp or 0 }}">
        </div>
        <div class="form-group">
            <label>股票（美元/元）:</label>
            <input type="number" step="0.01" name="stock_usd" value="{{ stock_usd or 0 }}">
        </div>
        <div class="form-group">
            <label>比特币（个）:</label>
            <input type="number" step="0.00000001" name="btc" value="{{ btc or 0 }}">
        </div>
        <div class="form-group">
            <label>比特币股票（美元/元）:</label>
            <input type="number" step="0.01" name="btc_stock_usd" value="{{ btc_stock_usd or 0 }}">
        </div>
        <div class="form-group">
            <label>流动性（人民币/元）:</label>
            <input type="number" step="0.01" name="savings_cny" value="{{ savings_cny or 0 }}">
        </div>
        <div class="form-group">
            <label>流动性（美元/元）:</label>
            <input type="number" step="0.01" name="savings_usd" value="{{ savings_usd or 0 }}">
        </div>
        <div class="form-group">
            <label>流动性（欧元/元）:</label>
            <input type="number" step="0.01" name="savings_eur" value="{{ savings_eur or 0 }}">
        </div>
        <div class="form-group">
            <label>流动性（新加坡元/元）:</label>
            <input type="number" step="0.01" name="savings_sgd" value="{{ savings_sgd or 0 }}">
        </div>
        <div class="form-group">
            <label>流动性（港币/元）:</label>
            <input type="number" step="0.01" name="savings_hkd" value="{{ savings_hkd or 0 }}">
        </div>
        <button type="submit">计算总资产</button>
    </form>
    
    {% if total_assets_usd is defined and total_savings_usd is defined and gold_ratio is defined and btc_ratio is defined%}
    <div class="result">
        <p>可用流动性: {{ "%.2f"|format(total_savings_usd) }} 美元</p>
        <p>可用流动性占总资产比例: {{ "%.2f"|format(available_liquidity_ratio) }} </p>
        <p>黄金占总资产比例: {{ "%.2f"|format(gold_ratio) }} </p>
        <p>比特币占总资产比例: {{ "%.2f"|format(btc_ratio) }} </p>
        <p>总资产: {{ "%.2f"|format(total_assets_usd) }} 美元</p>
    </div>
    {% endif %}

    <!-- 在表单下方添加下载按钮 -->
    {% if report_path %}
    <div class="download-section">
        <a href="{{ url_for('download_report', filename=report_path.split('/')[-1]) }}" 
        class="btn btn-primary">
            Download Report
        </a>
    </div>
    {% endif %}

</body>
</html>